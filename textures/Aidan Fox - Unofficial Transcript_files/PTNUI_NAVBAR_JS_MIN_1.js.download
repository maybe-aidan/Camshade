if (!(typeof removeClass == 'function')) {
 removeClass = function (obj, sClass0) {
 if (!obj) return; var sClass = (obj.getAttribute("class")) ? obj.getAttribute("class") : ""; sClass = sClass.replace(" " + sClass0, ""); sClass = sClass.replace(sClass0, ""); obj.setAttribute("class", sClass); }
}

if (!(typeof addClass == 'function')) {
 addClass = function (obj, sClass0) {
 if (!obj) return; var sClass = (obj.getAttribute("class")) ? obj.getAttribute("class") : ""; if (sClass.indexOf(" "+sClass0) != -1) return; obj.setAttribute("class", sClass + " "+sClass0); }
}

if (!(typeof toggleClass == 'function')) {
 toggleClass = function (obj, sClass0) {
 if (!obj) return; var sClass = (obj.getAttribute("class")) ? obj.getAttribute("class") : ""; if (sClass.indexOf(" "+sClass0) != -1)
 removeClass(obj, sClass0); else
 addClass(obj, sClass0); }
}

if (!(typeof DoNavBar == 'function')) {
 DoNavBar = function (url) {
 PTNavBar.Toggle(url); }
}

function getThemePortal() {
 var re = /portal:([\w]+)/; var tPortal = re.exec(getCookie("ps_theme")); if (tPortal != null && tPortal.length > 1)
 return tPortal[1]; else
 return "";}

var PTNavBar = {
 const_keyCode : { ARRLEFT : 37,ARRUP : 38,ARRRIGHT : 39,ARRDN : 40,ENTER : 13,
 ARROPEN : ("ltr" == "ltr") ? 39 : 37,ARRCLOSE : ("ltr" == "ltr") ? 37 : 39,
 ARRPREV: ("ltr" == "ltr") ? 37 : 39,ARRNEXT: ("ltr" == "ltr") ? 39 : 37,
 ESC : 27,TAB : 9, END : 35, HOME : 36
 }, 
 Url: "",
 CurTileEl: null,
 OpenState: "",
 StartPersState: "",
 IsOpen: false,
 IsLoaded: false,
 IframeDoc: null,
 IsSFF: false,
 IsAccessible: false,
 Delay: 1000,
 bDirty: false,
 unmruCref: "false", 
 hasMRU : false, 
 nMaxMRU : 100, 
 ptBaseURI : "",
 CurPortal : "",
 backMenuClicked: false,
 backMenuEl: "",
 lastMenuSectionFocus: "", 
 Load: function() {
 var psNBMask = document.createElement("div"); psNBMask.id = "psNavBarMask"; psNBMask.setAttribute('onclick', 'javascript:DoNavBar();'); var navBarEl = document.createElement("div"); navBarEl.id = "psNavBar"; navBarEl.setAttribute("class", "psNavBar PTNavBarModal"); var nBifel = document.createElement("iframe"); nBifel.id = "psNavBarIFrame"; nBifel.name = "psNavBarIFrame"; nBifel.onload = PTNavBar.FirstLoad; nBifel.title = "NavBar"; nBifel.frameBorder = "0"; nBifel.setAttribute("onmousewheel", "");  PTNavBar.CurPortal = getThemePortal(); if (typeof(sessionStorage) != "undefined") {
 var CachedUrl = sessionStorage.getItem("NavBarUrl_" + PTNavBar.CurPortal); if (CachedUrl != null)
 PTNavBar.Url = CachedUrl; }

 if (typeof(bFMode) == "undefined")
 bFMode = false; nBifel.src = encodeURI(PTNavBar.Url); navBarEl.appendChild(nBifel); var el = document.querySelector('body'); el.appendChild(psNBMask); el.appendChild(navBarEl); var sScript = "processing_empty"; if (eval ("typeof " + sScript + " !== 'function'")) {
 if (document.forms.length > 0)
 sScript = "processing_" + document.forms[0].name; if (bFMode == false) {
 if (typeof ptLoadingStatus_empty === 'function')
 sScript = "ptLoadingStatus_empty"; else {
 var tcFrame = "window.frames['TargetContent']"; if (typeof(window.frames['TargetContent']) !== 'undefined')
 if (window.frames['TargetContent'].document.forms.length > 0)
 sScript = tcFrame + ".processing_" + eval(tcFrame + ".document.forms[0].name"); }
 }
 }
 if (eval ("typeof " + sScript + " === 'function'")) {
 eval(sScript + "(1,1000);"); var rcTimeOutId = setInterval( function() {
 if (PTNavBar.IsLoaded == true) {
 eval(sScript + "(0,1000);"); clearInterval(rcTimeOutId); }
 }, 100); }
 PTNavBar.bDirty = false; PTNavBar.ptBaseURI = getptBaseURI(); },
 Refresh: function() {
 var el = document.querySelector('.PTNavBarModal'); if (el != null) {
 var elIF = el.querySelector('#psNavBarIFrame'); elIF.src = PTNavBar.IframeDoc.document.location.href; if (PTNavBar.IframeDoc.document.getElementById("PTNB$PTNUI_NB_MRU"))
 PTNavBar.hasMRU = true;  }
 PTNavBar.bDirty = false; },
 FirstLoad: function() {
 var el = document.querySelector('.PTNavBarModal'); removeClass(el, PTNavBar.OpenState); if (PTNavBar.IsOpen)
 addClass(el, PTNavBar.OpenState); PTNavBar.Delay = 0; var nbFrame = window.frames['psNavBarIFrame']; if (typeof nbFrame != 'undefined') {
 PTNavBar.IframeDoc = nbFrame; nbFrame.PTNavBar.SetHeaderLabel(''); }
 if (nbFrame.document.getElementById("PTNB$PTNUI_NB_MRU")) {
 PTNavBar.hasMRU = true;  PTNavBar.synchHNAVMRU(); }

 try {
 if (typeof(sessionStorage) != "undefined")
 sessionStorage.setItem("NavBarUrl_" + PTNavBar.CurPortal, nbFrame.location.href); } catch(ex) {
 }
 },
 Toggle: function(navBarUrl) {
 if (typeof(navBarUrl) != 'undefined') {
 PTNavBar.Url = navBarUrl; }

 var el = document.querySelector('.PTNavBarModal'); if (el == null) {
 this.Load(); el = document.querySelector('.PTNavBarModal'); }else if (PTNavBar.bDirty) {
 PTNavBar.Refresh(); }else {
 
 PTNavBar.synchHNAVMRU(); }
 this.IsOpen = !this.IsOpen; this.IsSFF = (document.querySelector('html').getAttribute('class') != null && document.querySelector('html').getAttribute('class').indexOf('psc_form-small') >= 0); this.IsAccessible = (getCookieValue('ps_theme').indexOf('accessibility:A') != -1); if (this.OpenState == '') {
 if (this.CurTileEl == null || this.IsSFF)
 this.OpenState = 'slidein'; else {
 this.OpenState = 'slidein_full'; }
 }

 var elBody = document.querySelector('body'); var nbMask = document.querySelector('#psNavBarMask'); var nbIF = document.querySelector('#psNavBarIFrame'); var nbIFBody = nbIF.contentWindow ? nbIF.contentWindow.document.querySelector('body') : nbIF.contentDocument.document.querySelector('body'); var elmod = document.getElementById('pt_modals'); if (this.IsOpen) {
 nbMask.style.cssText = "display:block"; elBody.style.cssText = "position: fixed; width: 100%; height: 100%; overflow: hidden; -webkit-backface-visibility: hidden; -webkit-transform: translateZ(0);"; if (this.IsAccessible) {
 elBody.style.cssText = elBody.style.cssText + " visibility: hidden;"; if (elmod) elmod.style.cssText = elmod.style.cssText + " visibility: visible;"; if (typeof hidePtWrapper == "function") hidePtWrapper(); addClass(nbMask, 'acs_mode'); addClass(el, 'acs_mode'); }
 this.SetFocus(); nbIF.tabIndex = 0; elBody.tabIndex = -1; nbIFBody.style.cssText = "display: block;"; }
 else {
 nbMask.style.cssText = "display:none"; elBody.style.cssText = ""; if (this.IsAccessible) {
 if (elmod) elmod.style.removeProperty ("visibility"); if (typeof unhidePtWrapper == "function") unhidePtWrapper(); removeClass(nbMask, 'acs_mode'); removeClass(el, 'acs_mode'); }
 nbIF.tabIndex = -1; elBody.tabIndex = -1; nbIFBody.style.cssText = "display: none;"; this.SetBlur(); }

 if (this.Delay == 0)
 toggleClass(el, this.OpenState); if (this.IframeDoc != null) {
 PTNavBar.ToggleAriaShowHide(); }

 
 if (this.IframeDoc != null && this.IsOpen) {
 if (this.OpenState == 'slidein')
 this.IframeDoc.PTNavBar.SelectTile(this.IframeDoc.PTNavBar.CurTileEl); else
 if (this.OpenState == 'slidein_full')
 this.IframeDoc.PTNavBar.SetContentFocus(); }

 
 if (typeof(doCloseLocalModals) == 'function') {
 doCloseLocalModals(); if (this.IsSFF && this.IsAccessible && this.IsOpen) {
 if (typeof hidePtWrapper == "function") hidePtWrapper(); }
 if (this.IframeDoc != null && typeof(this.IframeDoc.doCloseLocalModals) == 'function')
 this.IframeDoc.doCloseLocalModals(); }
 },

 ClearNBMenuStorage:function(){
 
 Object.keys(sessionStorage).map(function(c,i,a){
 
 if (c.indexOf("psNavBar")!= -1)
 sessionStorage.removeItem(c); }); },

 SetInitialSectionFocus: function(){
 
 var sectionMenu = document.querySelector("ul.ps_box-scrollarea.ps_box-menucontainer li.ps_box-menuitem:first-child div.nui-menu-section a"); if (sectionMenu) {
 sectionMenu.setAttribute("tabindex", "0");  PTNavBar.lastMenuSectionFocus = sectionMenu.id;  sectionMenu.focus(); }
 },

 SetInitialBreadCrumb:function(parentId, parentLabel, bcURL){
 
 PTNavBar.SetInitialSectionFocus();  if (typeof(sessionStorage) == "undefined") 
 return; var bcLink = "<li role='presentation' class='nui-menu-bc'>"; bcLink += "<a id='" + "bc0_" + parentId + "' href='javascript:PTNavBar.OpenInContentArea(%27"; bcLink += bcURL + "%27,%27" + parentId + "%27)'"; bcLink += " onclick='PTNavBar.UpdateBreadCrumb(event)'"; bcLink += " aria-label='Main Menu'"; bcLink += " role='menuitem'>"; bcLink += parentLabel; bcLink += "</a></li>"; sessionStorage.setItem("psNavBar_BC", bcLink); },
 
 SetBreadcrumb: function(event){
 
 if ((typeof(sessionStorage) == "undefined") || (typeof(event) == "undefined"))
 return; var bc_sessionItem = sessionStorage.getItem("psNavBar_BC"); var bcArray = bc_sessionItem.split("|"); var num = bcArray.length > 0 ? (bcArray.length) : 0; var parentId = event.target.getAttribute("ptfid"); if (parentId)
 parentId = parentId.replace("fldra_", "bc" + num + "_"); else 
 parentId = "bc_MENUITEM";  var liItem = "<li role='presentation' class='nui-menu-bc'>"; liItem += "<a id='" + parentId + "' role='menuitem' href='" + event.target.href +"'"; liItem += " onclick='PTNavBar.UpdateBreadCrumb(event)'"; liItem += ">"; liItem += event.target.textContent; liItem += "</a></li>"; if (bc_sessionItem)
 bc_sessionItem = bc_sessionItem + "|" + liItem; else
 bc_sessionItem = liItem;  sessionStorage.setItem("psNavBar_BC", bc_sessionItem);  },
 
 UpdateBreadCrumb: function(event){
 
 if (typeof(sessionStorage) == "undefined") 
 return; var bc_sessionItem = sessionStorage.getItem("psNavBar_BC"); var bcArray = bc_sessionItem.split("|"); if (!bc_sessionItem)
 return; var itemArr = event.target.id.split("_"); var itemId = itemArr[0]; itemId = itemId.replace("bc", ""); var newBCList=""; bcArray = bcArray.slice(0, parseInt(itemId)+1); for (var i=0; i<bcArray.length; i++) {
 if (i>0)
 newBCList += "|"; newBCList += bcArray[i]; }
 sessionStorage.setItem("psNavBar_BC", newBCList);  },
 
 ShowBreadCrumb: function(){
 
 if (typeof(sessionStorage) == "undefined") 
 return; var bcContainer = document.querySelector(".nui-menu-bc"); if (bcContainer){
 var htmlDoc = document.getElementsByTagName("html"); var bcItem = sessionStorage.getItem("psNavBar_BC"); var bcArray = bcItem.split("|"); bcItem = ""; for (var i=0; i<bcArray.length-1; i++){
 bcItem += bcArray[i]; }
 
 if (bcItem){
 bcContainer.innerHTML = bcItem; }
 }
 },

 SetNBContainerTabIndex : function(tindex) {
 
 var divObj = document.querySelector("div.ps_box-group.psc_layout.nbcontarea"); if (divObj)
 divObj.setAttribute("tabindex", tindex); },


 OpenInContentArea: function(url, cacheId) {
 var cacheHTML = null; var prevFldr = null; var backMenuPrevEl = PTNavBar.backMenuEl; if (typeof(cacheId) == "string" && typeof(sessionStorage) != "undefined") {
 var tCacheId = "psNavBarCont_" + top.PTNavBar.CurPortal + "_" + cacheId + "_" + top.document.documentElement.lang; cacheHTML = sessionStorage.getItem(tCacheId); }
 var nbContEl = document.querySelector('.nbcontarea'); if (cacheHTML == null) {
 LaunchURL(null, url,3,'bGrouplet@1;','NB_CONTENT_TGT'); } else {
 if (url.indexOf("PTNUI_MENU_COMP") > -1){
 if (PTNavBar.backMenuClicked == true || document.activeElement.id == "PTNUI_MENU_BACKBTN") {
 prevFldr = sessionStorage.getItem("psNavBar_lastFolder"); }
 PTNavBarNavigator.SetLastNavFolder(cacheId); }
 nbContEl.innerHTML = cacheHTML;  PTNavBar.ShowBreadCrumb();  if ((PTNavBar.backMenuClicked == false) && (cacheId == "PORTAL_ROOT_OBJECT")) 
 PTNavBar.SetInitialSectionFocus();  if (PTNavBar.backMenuClicked == true) 
 PTNavBar.backMenuClicked = false;  if (prevFldr != null) {
 var pos = prevFldr.indexOf(":");  if (pos != -1) prevFldr = prevFldr.substring(pos + 1); var listItems = document.querySelectorAll('.lplistitem.fldr a'); var listFldr=null; for (var i = 0; i < listItems.length; i++) {
 listFldr= listItems[i].getAttribute("ptfid"); if (pos != -1) { 
 pos = listFldr.indexOf("_PTUN");  listFldr = listFldr.substring(0, pos); }
 if (listFldr == "fldra_" + prevFldr) {
 if (i >= 0) { 
 
 listItems[0].removeAttribute('sfocus');  listItems[0].setAttribute("tabindex","-1");  listItems[i].setAttribute("sfocus",""); listItems[i].setAttribute("tabindex","0"); }
 break; }
 }
 }

 
 PTNavBar.SetContentFocus(); }
 if (top.PTNavBar.IsAccessible) {
 var t2 = setTimeout(function() {
 PTNavBar.backMenuEl = document.querySelector(".ptnui_menu_back a"); if (!backMenuPrevEl && PTNavBar.backMenuEl != null)
 PTNavBar.SetAnnounceText("The back to parent and back to root buttons are available to use."); if (backMenuPrevEl != null && PTNavBar.backMenuEl == null)
 PTNavBar.SetAnnounceText("The back to parent and back to root buttons are no longer available."); clearTimeout(t2);},1000);  }
 },
 OpenInWindow: function(url, crefID, crefLabel) {
 if ((typeof crefID != "undefined")){
 PTNavBar.saveMRU(crefID, crefLabel, url);  }
 LaunchURL(null, url, 4); },
 saveMRU: function (crefID, crefLabel, url,FromTile) {
 
 top.PTNavBar.ptBaseURI = getptBaseURI(); var ajaxUrl = top.PTNavBar.ptBaseURI + "s/WEBLIB_PT_NAV.ISCRIPT1.FieldFormula.IScript_PT_NAV_MRU_Update"; var isUnav = "false";  var sVal = "", s = ptUtil.id("PTNUI_NB_WRK_PTNUI_SSID"); if (s) { 
 if (!/ptnbsid/.test(s.value))
 sVal = "&ptnbsid=" + s.value; else
 sVal = "&" + s.value;  } 

 if (top.PTNavBar.unmruCref == "false"){
 if((String(url).indexOf("cmd=uninav&Rnode=") != -1) || (String(url).indexOf("?tab=REMOTEUNIFIEDDASHBOARD") != -1 )){
 
 
 var isUnav = "true"; var Unavcref = "DUMMY_PTUN"; var Unavcreflbl = "DUMMY OBJECT";  if (top.PTNavBar.ptBaseURI != "" && String(top.PTNavBar.ptBaseURI).indexOf("/psc/") != -1) 
 {
 ajaxUrl = getptBaseURI()+ "s/WEBLIB_PT_NAV.ISCRIPT1.FieldFormula.IScript_PT_NAV_MRU_Update"; }
 
 
 
 var url1 = decodeURIComponent(url);  var PtunStr = url1.substring(url1.indexOf("{PTUN_")); PtunStr = PtunStr.substring(1,PtunStr.indexOf(","));  var pairs = url1.split("}."); if(pairs.length > 0)
 {
 
 var pair = pairs[pairs.length-1]; Unavcreflbl = String(pair).substring(0,pair.indexOf("{"));    Unavcreflbl = Unavcreflbl.replace("\\'", "'"); Unavcref = String(pair).substring(pair.indexOf("{")+1,pair.indexOf("}")); Unavcref = Unavcref + "_" +PtunStr; }
 
 top.PTNavBar.unmruCref = Unavcref + "$$$" + Unavcreflbl;  top.PTNavBar.unmruCrefhref = url; crefID = top.PTNavBar.unmruCref;  }

 if (typeof FromTile != "undefined" && FromTile == "True"){
 var isTile = "true";  if (top.PTNavBar.ptBaseURI != "" && String(top.PTNavBar.ptBaseURI).indexOf("/psc/") != -1) 
 {
 ajaxUrl = getptBaseURI()+ "s/WEBLIB_PT_NAV.ISCRIPT1.FieldFormula.IScript_PT_NAV_MRU_Update"; }
 
 top.PTNavBar.unmruCref = crefID + "$$$" + crefLabel;  top.PTNavBar.unmruCrefhref = url; crefID = top.PTNavBar.unmruCref;  } 
 } 

 var params = "mrulist=" + encodeURIComponent(crefID) + "&mruAction=ptmruinst&maxMRU="+ top.PTNavBar.nMaxMRU + sVal; if (isUnav == "true" || isTile == "true") 
 params = params + "&unmruCref=" + encodeURIComponent(top.PTNavBar.unmruCref) + "&unmruCrefhref=" + encodeURIComponent(top.PTNavBar.unmruCrefhref);  if (isTile == "true") 
 params = params + "&FromTile=true";  if (typeof crefLabel != "undefined") 
 {
 var urlArray = PTNavBar.URLToArray(url); params = params + "&unfromNavBar=true&unmruCref=" + crefLabel + "&" + PTNavBar.ArrayToURL(urlArray); }
 
 var mruLoader = new net2.ContentLoader(ajaxUrl,null,null,"post",function(){},
 null,params,"application/x-www-form-urlencoded",1,0,null,false); mruLoader = null; },

 URLToArray: function (url) {
 var request = {}; var arr = [];  var pairs =url.split('&'); for (var i = 0; i < pairs.length; i++) {
 var pair = []; if (i === 0 )
 {
 pair[0] = "unnavbarUrl"; pair[1] = pairs[0]; } 
 else
 pair = pairs[i].split('=');  if(PTNavBar.endsWith(decodeURIComponent(pair[0]), '[]') ) {
 var arrName = decodeURIComponent(pair[0]).substring(0, decodeURIComponent(pair[0]).length - 2); if(!(arrName in arr)) {
 arr.push(arrName); arr[arrName] = []; }

 arr[arrName].push(decodeURIComponent(pair[1])); request[arrName] = arr[arrName]; } else {
 request[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]); }
 }
 return request; },

 endsWith: function (str, suffix) {
 return str.indexOf(suffix, str.length - suffix.length) !== -1; },

 ArrayToURL: function (array) {
 var pairs = []; for (var key in array)
 if (array.hasOwnProperty(key))
 pairs.push(encodeURIComponent(key) + '=' + encodeURIComponent(array[key])); return pairs.join('&');},
 synchHNAVMRU: function() { 
 if (!PTNavBar.hasMRU)
 return;   if ((typeof top.pthNav != "undefined") && top.pthNav.mruRoot && !top.pthNav.mru.dbSaved && top.pthNav.mruRoot.childNodes.length > 0) { 
 top.pthNav.mru.save();  } 
 },
 
 SetContentAreaCache: function(cacheId) {
 try {
 if (typeof(sessionStorage) == "object") {
 cacheId = "psNavBarCont_" + top.PTNavBar.CurPortal + "_" + cacheId + "_" + top.document.documentElement.lang; var nbContEl = document.querySelector('.nbcontarea'); sessionStorage.setItem(cacheId, nbContEl.innerHTML); }
 } catch(ex) {
 }
 },
 SetHeaderLabel: function(lbl) {
 var nbHdrLabelEl = document.querySelector('.nbhdr .nbhdr_lbl > span'); if (nbHdrLabelEl) {
 var nbHdrLabel = nbHdrLabelEl.innerHTML; var needle = ": "; var lblArr = nbHdrLabel.split(needle); if (lbl == "")
 nbHdrLabel = lblArr[0]; else
 nbHdrLabel = lblArr[0] + needle + lbl; nbHdrLabelEl.innerHTML = nbHdrLabel; if (nbHdrLabel == lblArr[0]) {
 if (top.PTNavBar.IsAccessible && top.PTNavBar.OpenState == 'slidein') {
 addClass(nbHdrLabelEl, 'psc_hidden-readable'); } else {
 removeClass(nbHdrLabelEl, 'psc_hidden-readable'); }
 } else {
 removeClass(nbHdrLabelEl, 'psc_hidden-readable'); }
 }
 },
 SelectTile: function(el) {
 if (PTNavBar.CurTileEl != null) {
 toggleClass(PTNavBar.CurTileEl, 'sel'); PTNavBar.CurTileEl.removeAttribute("aria-current"); PTNavBar.CurTileEl.setAttribute("aria-expanded", "false");  PTNavBar.CurTileEl.removeAttribute("aria-controls"); PTNavBar.CurTileEl.removeAttribute("aria-haspopup"); if (PTNavBar.CurTileEl != el)
 
 PTNavBar.CurTileEl.setAttribute("tabindex", "-1"); } else {
 
 if (el != null) {
 var nbtiles = el.parentNode.parentNode.children; for (var i = 0; i < nbtiles.length; i++) {
 if (nbtiles[i].lastElementChild.tabIndex == "0") {
 nbtiles[i].lastElementChild.removeAttribute("aria-current"); nbtiles[i].lastElementChild.setAttribute("tabindex", "-1"); break; }
 }
 }
 }

 window.top.PTNavBar.IframeDoc = window.self; if (PTNavBar.CurTileEl == el || el == null) {
 PTNavBar.CurTileEl = null; PTNavBar.HideContentArea(); PTNavBar.SetHeaderLabel(''); if (el != null)
 el.focus();  } else {
 var label = el.querySelector('.ps_groupleth .ps-label'); if (label) {
 PTNavBar.SetHeaderLabel(label.innerHTML); }
 this.CurTileEl = el; toggleClass(PTNavBar.CurTileEl, 'sel'); PTNavBar.CurTileEl.setAttribute("aria-current", "true"); PTNavBar.CurTileEl.setAttribute("aria-expanded", "true"); PTNavBar.CurTileEl.setAttribute("aria-haspopup", "true"); PTNavBar.CurTileEl.setAttribute("tabindex", "0"); var nbContEl = document.querySelector(".nbcontarea"); if (nbContEl != null) {
 PTNavBar.CurTileEl.setAttribute("aria-controls", nbContEl.id);  }; if (top.PTNavBar.IsAccessible ) {
 var curTileLabel = PTNavBar.CurTileEl.querySelector('.ps_groupleth > .ps-label').innerHTML; var nbRegionEl = document.querySelector('.nbcacont'); if (nbRegionEl && curTileLabel) nbRegionEl.setAttribute("aria-label", curTileLabel); var setTabNoData = function() {
 nbContEl = document.getElementById('PT_NAV_WRK_GROUPBOX2lbl'); if ((PTNavBar.CurTileEl.id == "PTNB$PTNUI_NB_MRU" || PTNavBar.CurTileEl.id == "PTNB$PTNUI_NB_FAV") && document.querySelectorAll('.nbcacont .lplistgrid').length == 0) {
 PTNavBar.CurTileEl.removeAttribute("aria-haspopup");  }
 }; var t1 = setTimeout(function() {setTabNoData();clearTimeout(t1);},1000); }; PTNavBar.ShowContentArea(); }; },
 ShowContentArea: function() {
 if (top.PTNavBar.OpenState != 'slidein_full') {
 var el = top.document.querySelector('.PTNavBarModal'); if (window.top != window.self) {
 window.top.PTNavBar.OpenState = 'slidein_full'; PTNavBar.OpenState = 'slidein_full'; var hdr_el = document.querySelector('.ptnavbar'); removeClass(hdr_el, 'nbmin'); var nbcont_el = document.querySelector('.nbcacont'); removeClass(nbcont_el, 'psc_hidden');  PTNavBar.SetContentFocus(); PTNavBar.ToggleAriaShowHide(); }; replaceClass(el, 'slidein', this.OpenState); }
 else
 PTNavBar.SetContentFocus(); },
 HideContentArea: function() {
 if (top.PTNavBar.OpenState != 'slidein_full') {
 
 return; }; if (window.top != window.self) {
 window.top.PTNavBar.OpenState = 'slidein'; PTNavBar.OpenState = 'slidein'; var hdr_el = document.querySelector('.ptnavbar'); addClass(hdr_el, 'nbmin'); var nbcont_el = document.querySelector('.nbcacont'); addClass(nbcont_el, 'psc_hidden');  PTNavBar.ToggleAriaShowHide(); }; var el = top.document.querySelector('.PTNavBarModal'); replaceClass(el, 'slidein_full', this.OpenState); },
 StartPersonalization: function() {
 PTNavBar.ShowContentArea(); window.top.PTNavBar.StartPersState = PTNavBar.OpenState; setPSTouchHandlerDraggbles(); var elperstiles = document.querySelectorAll('.nbpers .nbtile-row');  if (elperstiles && elperstiles.length !== 0) {
 for (var i = 0; i < elperstiles.length; i++) {
 elperstiles[i].setAttribute("aria-labelledby", "PTNUI_DOCK_REC_TITLE$" + i); }
 } 
 },
 StopPersonalization: function() {
 if (window.top.PTNavBar.StartPersState == 'slidein')
 PTNavBar.HideContentArea(); window.top.PTNavBar.StartPersState = ''; window.top.PTNavBar.IsLoaded = true; },
 InitDefaultTile: function() {
 var hdr_el = document.querySelector('.ptnavbar'); if (window.top.PTNavBar.OpenState == 'slidein_full')
 removeClass(hdr_el, 'nbmin'); else
 addClass(hdr_el, 'nbmin'); this.HideContentArea(); var listItems = document.querySelectorAll('.nuinb'); listItems[0].tabIndex = 0; for (var i = 1; i < listItems.length; i++) {
 listItems[i].tabIndex = -1; }
 },
 SetBlur: function() {
 var el; if (this.IsSFF)
 el = top.document.getElementById("PT_ACTION_MENU$PIMG"); else
 el = top.document.querySelector('#PT_NAVBAR');  if (el == null)
 el = top.document.querySelector('#pthdr2navbar'); if (el != null)
 el.focus(); },
 SetFocus: function() {
 var fInterval = setInterval(function() {
 try {
 var fEl = window.frames['psNavBarIFrame'].document.querySelector('#PTNUI_NB_HDRWRK_PTNUI_NB_ACTION'); if (!fEl)
 {
 
 fEl = PTNavBar.IframeDoc.document.querySelector('#PTNUI_NB_HDRWRK_PTNUI_ACTION_LINK2'); if (!fEl || fEl && fEl.parentElement.parentElement.offsetParent == null)
 {
 var objs = window.frames['psNavBarIFrame'].document.querySelectorAll('[tabindex="0"]'); for (var i = 0, j = 0; i < objs.length; i++, j++) 
 {
 if (objs[i].offsetParent == null) continue; fEl = objs[i]; if (j > 0)
 break; }
 }
 }
 if (fEl) 
 {
 clearInterval(fInterval); fEl.focus(); }
 } 
 catch(e) {}; }, 200); },
 kbHandler: function(e) {
 var kbSetFocus = function(el, e) {
 if (el) {
 el.focus(); e.preventDefault(); e.stopPropagation(); }
 }; var e = window.event || e;  var fEl = document.activeElement; if (typeof fEl == "undefined" || fEl == null) return; var nbContEl = document.querySelector(".nbcacont"); if (nbContEl == null) return; var fElClass = fEl.getAttribute("class"); if (typeof fElClass == "undefined" || fElClass == null) return; var isTile = (fElClass.indexOf("nuinb") > -1); var isTilePers = (fElClass.indexOf("nbtile-row") > -1 && window.top.PTNavBar.StartPersState != null); var inCont = (nbContEl.compareDocumentPosition(fEl) & Node.DOCUMENT_POSITION_CONTAINED_BY); var isListItem = false; var isFolder = false; var isMenuSection = false;  var menuRowEl; if (inCont > 0) {
 menuRowEl = fEl.parentElement.parentElement; isListItem = ((menuRowEl.getAttribute("class").indexOf("lplistitem") > -1) && (menuRowEl.getAttribute("class").indexOf("nb-menu-link") > -1))?true:false;  isFolder = ((menuRowEl.getAttribute("class").indexOf("fldr") > -1) || (menuRowEl.getAttribute("class").indexOf("categorylist") > -1));  isMenuSection = ((fEl.tagName.toUpperCase() == "A") && (menuRowEl.className.indexOf("nui-menu-section") > -1))? true: false;  }

 switch (e.keyCode) {
 case PTNavBar.const_keyCode.TAB: 
 var winName = ((typeof document.forms != "undefined") && (document.forms.length > 0)) ? document.forms[0].name : "win1"; if (e.target.id == "ICLastAnchor_" + winName) {
 var elGear = document.getElementById("PTNUI_NB_HDRWRK_PTNUI_NB_ACTION"); var elClose = document.getElementById("PTNUI_NB_HDRWRK_PTNUI_ACTION_LINK2"); var elCancel = null; if (nbContEl.getAttribute("class").indexOf("addtilecontainer") > -1)
 elCancel = document.getElementById("PTUN_GSRC_N_WRK_CANCEL_BTN");  else
 elCancel = document.getElementById("PTNUI_NB_HDRWRK_PTNUI_BACK_BTN");  if (elGear && elGear.offsetParent != null)
 kbSetFocus(elGear,e);  else if (elClose && elClose.offsetParent != null)
 kbSetFocus(elClose,e);  else if (elCancel && elCancel.offsetParent != null)
 kbSetFocus(elCancel, e); else {
 var firstElem = document.getElementById("PTNUI_DOCK_REC$0_row_0"); if ((typeof firstElem != "undefined") && (firstElem!= null) && (firstElem.childNodes.length >= 3))
 kbSetFocus(firstElem.childNodes[2],e);  }
 }
 else if (e.shiftKey && (e.target.id == "ICFirstAnchor_" + winName)) {
 if (top.PTNavBar.OpenState == 'slidein_full') {
 if (window.top.PTNavBar.StartPersState == "") {
 var elnbcont = document.querySelector('.nbcontarea .nui-myfav-gb li a[tabindex="0"]'); if (elnbcont) {
 kbSetFocus(elnbcont,e);  break; }
 }
 else {
 var elperstiles = document.querySelectorAll('.nbpers .nbtile-row');  if (elperstiles && elperstiles.length !== 0) {
 var elpers = elperstiles[elperstiles.length - 1]; var eltiledelbtn = elpers.parentElement.querySelector('.nbtile-del-btn > .psc_image_only:not(.psc_hidden) a'); if (eltiledelbtn)
 kbSetFocus(eltiledelbtn,e); else 
 kbSetFocus(elpers,e); break;  } 
 else {
 var eladdthdr = document.querySelector('.addtilesrchcontainer .ptnui_menu_hdr');  if (eladdthdr && hasClass(eladdthdr, "psc_hidden"))
 var eladdt = document.querySelector('.nbcacont .lplistgrid li:first-child .lplistitem.categorylist a');  else 
 var eladdt = document.querySelector('.nbcacont .lplistgrid li:first-child .lplistitem:not(.categorylist) a'); if (eladdt) kbSetFocus(eladdt,e);  break;  }
 }
 } 
 var elnbcurr = document.querySelector('.nbtilegrid .nuinb[tabindex="0"]');  if (elnbcurr) kbSetFocus(elnbcurr,e);  }
 break; case PTNavBar.const_keyCode.ENTER: 
 if (isMenuSection){
 var prevFocus = document.getElementById(PTNavBar.lastMenuSectionFocus); if (prevFocus)
 prevFocus.setAttribute("tabindex", "-1"); fEl.setAttribute("tabindex", "0"); PTNavBar.lastMenuSectionFocus = fEl.id; }
 break; case PTNavBar.const_keyCode.ESC: 
 if (isFolder || isListItem) {
 
 var bcList = document.querySelector("ul.ps_box-group.ps_box-menucontainer.pt_keynav-list.nui-menu-bc"); if (bcList && (bcList.childNodes.length > 0) ){
 var bcItem = bcList.querySelector("li:last-child a"); if (bcItem) {
 PTNavBar.backMenuClicked = true;  bcItem.click(); break; }
 }
 }
 if (typeof bPTDrag != "undefined" && bPTDrag)
 bPTDrag = false; else {
 top.PTNavBar.Toggle(); PTNavBar.SetBlur(); }
 e.preventDefault(); break; case PTNavBar.const_keyCode.END: 
 var nextEl = null; if (isListItem) {
 var nextRowEl = fEl.parentElement.parentElement.parentElement.parentElement.querySelector("li:last-child"); if (nextRowEl) {
 nextEl = nextRowEl.querySelector(".lplistitem a"); }
 }
 if (isTile) {
 nextEl = document.querySelector(".nbtilegrid .ps_grid-body>li:last-child .nuinb"); }
 if (nextEl) {
 nextEl.focus(); e.preventDefault(); e.stopPropagation(); }
 break; case PTNavBar.const_keyCode.HOME:
 var nextEl = null; if (isListItem) {
 var nextRowEl = fEl.parentElement.parentElement.parentElement.parentElement.querySelector("li:first-child"); if (nextRowEl) {
 nextEl = nextRowEl.querySelector(".lplistitem a"); }
 }
 if (isTile) {
 nextEl = document.querySelector(".nbtilegrid .ps_grid-body>li:first-child .nuinb"); }
 kbSetFocus(nextEl,e); break; case PTNavBar.const_keyCode.ARRPREV: 
 
 var bcList = document.querySelector("ul.ps_box-group.ps_box-menucontainer.pt_keynav-list.nui-menu-bc"); if (bcList && (bcList.childNodes.length > 0) ){
 var bcItem = bcList.querySelector("li:last-child a"); if (bcItem) {
 PTNavBar.backMenuClicked = true;  bcItem.click(); }
 }else if (document.querySelector("div.nui-menu-section")){
 
 var sectionID = fEl.getAttribute("ptsectionid"); if (sectionID) {
 var sectionGrp = document.getElementById(sectionID); if (sectionGrp) {
 fEl.setAttribute("tabindex", "-1"); PTNavBar.lastMenuSectionFocus = "PTNUI_MENU_DV_PTNUI_MENU_GRP$0";  var firstSection = document.getElementById(PTNavBar.lastMenuSectionFocus); if (firstSection) 
 firstSection.setAttribute("tabindex", "0");  sectionGrp.focus(); }
 } 
 } 
 break; case PTNavBar.const_keyCode.ARRUP: 
 var nextEl = null; var nextRowEl = null;  if (isTile) {
 var nextRowEl = fEl.parentElement.previousElementSibling; if (nextRowEl) {
 nextEl = nextRowEl.querySelector(".nuinb"); }
 } else if (isTilePers) {
 nextRowEl = fEl.parentElement.previousElementSibling; if (nextRowEl) {
 nextEl = nextRowEl.querySelector(".nbtile-row"); }
 } else if (isListItem) {
 nextRowEl = menuRowEl.parentElement.previousElementSibling; if (!nextRowEl) 
 nextRowEl = menuRowEl.parentElement.parentElement.lastElementChild;  if (nextRowEl)
 nextEl = nextRowEl.querySelector(".lplistitem a");  }else if (isMenuSection){
 nextRowEl = menuRowEl.parentElement.previousElementSibling; if (nextRowEl)
 nextEl = nextRowEl.querySelector("div.nui-menu-section a"); else {
 
 nextRowEl = menuRowEl.parentElement.parentElement.lastElementChild; if (nextRowEl)
 nextEl = nextRowEl.querySelector("div.nui-menu-section a"); }
 
 }
 kbSetFocus(nextEl,e); break; case PTNavBar.const_keyCode.ARROPEN: 
 if (isFolder) fEl.click(); else {
 if (isMenuSection){
 var sectionMenus = menuRowEl.nextElementSibling.querySelector("ul.ps_grid-body.ps_box-menucontainer li.ps_box-menuitem:first-child a");  if (sectionMenus){ 
 sectionMenus.focus(); }
 }
 }
 break; case PTNavBar.const_keyCode.ARRDN: 
 var nextEl = null; var nextRowEl = null; if (isTile) {
 var nextRowEl = fEl.parentElement.nextElementSibling; if (nextRowEl) {
 nextEl = nextRowEl.querySelector(".nuinb"); }
 } else if (isTilePers) {
 nextRowEl = fEl.parentElement.nextElementSibling; if (nextRowEl) {
 nextEl = nextRowEl.querySelector(".nbtile-row"); }
 } else if (isListItem) {
 nextRowEl = menuRowEl.parentElement.nextElementSibling; if (!nextRowEl) {
 
 nextRowEl = menuRowEl.parentElement.parentElement.firstElementChild; }
 if (nextRowEl) 
 nextEl = nextRowEl.querySelector(".lplistitem a");  } else if (isMenuSection){
 nextRowEl = menuRowEl.parentElement.nextElementSibling; if (nextRowEl)
 nextEl = nextRowEl.querySelector("div.nui-menu-section a"); else {
 
 nextRowEl = menuRowEl.parentElement.parentElement.firstElementChild; if (nextRowEl)
 nextEl = nextRowEl.querySelector("div.nui-menu-section a"); }
 
 }
 kbSetFocus(nextEl,e); break; default:
 break; }
 },

 SetContentFocus : function() {
 var currURL = null; if(typeof window != 'undefined' && window && typeof window.location != 'undefined' && window.location) 
 currURL = window.location.href; if(typeof currURL != 'undefined' && currURL && currURL.indexOf("ptreqfrom=rc") != -1)
 return; var tDelay = 0; if (PTNavBar.CurTileEl && PTNavBar.CurTileEl.id == "PTNB$PTNUI_NB_FAV")
 tDelay = 500; PTNavBar.SetAnnounceText(""); var t = setTimeout(function() {
 var fEl = document.querySelector("a[sfocus]"); if (fEl) {
 fEl.focus(); if (PTNavBar.CurTileEl && PTNavBar.CurTileEl.id == "PTNB$PTNUI_NB_FAV")
 PTNavBar.SetAnnounceText("You can select the Edit Favorites button to access the Edit Favorites page"); }
 clearTimeout(t);},tDelay); },
 ToggleAriaShowHide : function() {
 var showhide = !top.PTNavBar.IsOpen; var nbshowhide = showhide; if (top.PTNavBar.IsSFF && top.PTNavBar.IsAccessible)
 nbshowhide = !(top.PTNavBar.IsOpen && top.PTNavBar.OpenState == 'slidein'); var nbtiles = top.PTNavBar.IframeDoc.document.querySelectorAll(".nbtilegrid .nuinb"); for (var i = 0; i < nbtiles.length; i++) {
 nbtiles[i].setAttribute("aria-hidden", nbshowhide); }; var persEl = top.PTNavBar.IframeDoc.document.querySelector('#PTNUI_NB_HDRWRK_PTNUI_NB_ACTION'); if (persEl)
 persEl.setAttribute("aria-hidden", showhide);  var closeEl = top.PTNavBar.IframeDoc.document.querySelector('#PTNUI_NB_HDRWRK_PTNUI_ACTION_LINK2'); if (closeEl)
 closeEl.setAttribute("aria-hidden", showhide); },
 SetAnnounceText : function(str) {
 var ariaLiveEl = document.querySelector(".ps_box-announce.ps_alert-normal"); if (ariaLiveEl) {
 var originalStr = unescape(str); var t = document.createTextNode(originalStr); if (!t) return; while (ariaLiveEl.firstChild) {
 ariaLiveEl.removeChild(ariaLiveEl.firstChild); }
 ariaLiveEl.appendChild(t); }
 },
 SetPersTileFocus: function(row) {
 if (!row) row=0; var el=document.querySelectorAll('.nbpers .nbtile-row')[row]; if (!el || (el && hasClass(el.parentElement, 'nuihidden')))
 el=document.querySelectorAll('.nbpers .nbtilegrid li:not(.nuihidden) > .nbtile-row')[0]; if (el) el.focus(); }
};var PTNavBarNavigator = {
 SetLastNavFolder : function(fldr) {
 try {
 if (typeof(sessionStorage) == "object") {
 sessionStorage.setItem("psNavBar_lastFolder", fldr); }
 } catch(ex) {
 }
 }
};